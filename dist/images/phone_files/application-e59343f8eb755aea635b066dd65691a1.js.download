function shake(a){function g(){var c=f.shift(),d=f.length?g:a;new Effect.Morph(b,{style:{marginRight:c[0]+"px"},duration:c[1],afterFinish:d})}var b=$("iphone_movie"),c=.9,d=c/10,e=18,f=[[e,d*2],[-e*4,d],[e*4,d],[-e*3,d],[e,d],[-e*2,d],[e,d],[-e*1,d],[e,d],[-e*.5,d],[0,d]];g()}function trackClick(a,b){((function(){window._gaq&&_gaq.push&&_gaq.push(["_trackPageview",a]),new Ajax.Request("/characters/"+b+"/update_counter",{method:"PUT"})})).defer()}Object.extend(String.prototype,{ensureEndsWith:function(a){return this.endsWith(a)?this:this+a},px:function(){return this.ensureEndsWith("px")}}),Object.extend(Number.prototype,{px:function(){return this.toString().px()}}),Object.extend(Event,{isStandardClick:function(a){return!a.metaKey&&!a.ctrlKey&&!a.shiftKey}}),Object.extend(Prototype,{falseFunction:function(){return!1}}),function(){var a={flash:function(a,b,c){var d=a.innerHTML;return a.update(b),function(){a.update(d)}.delay(c||3),a},toggleValue:function(a,b){a.__value=a.__value||a.innerHTML,b=b||a.readAttribute("alternate-value");var c=a.innerHTML==a.__value?b:a.__value,d=c.toLowerCase().replace(/[^a-zA-Z0-9\-_]/,"_");return a.update(c),a.fire("toggle:"+d),a},upwards:function(a,b){return a=$(a),a.match(b)?a:a.up(b)},downwards:function(a,b){return a=$(a),a.match(b)?a:a.down(b)},updateWithRemote:function(a,b,c){c=c||{},c.method=c.method||"GET";var d=c.loadingClassOn,e=c.loadingClass||"loading";d&&(d=$(d),c._onLoading=c.onLoading,c._onComplete=c.onComplete,c=Object.extend(c,{onLoading:function(){d.addClassName(e),c._onLoading&&c._onLoading()},onComplete:function(){d.removeClassName(e),c._onComplete&&c._onComplete()}})),new Ajax.Updater(a,b,c)}};a.toggleClass=Element.Methods.toggleClassName,a.addClass=Element.Methods.addClassName,a.hasClass=Element.Methods.hasClassName,a.removeClass=Element.Methods.removeClassName,Element.addMethods(a)}(),function(){var a={};$w("blur focus load resize scroll unload click dblclick readymousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").each(function(b){a["$"+b]=function(a,c){return Event.observe(a,b,c)}}),Element.addMethods(a),Object.extend(document,{ready:Event.observe.curry(document,"dom:loaded")})}(),$(document).observe("dom:loaded",function(){$(document.body).observe("click",function(a){if(!Event.isStandardClick(a))return;var b=a.findElement("a[data-remote][data-update]");b&&(b.addClassName("loading"),b.observe("ajax:complete",function(a){var c=b.readAttribute("data-update");c=="true"&&(c=b),$(c).update(a.memo.responseText),b.removeClassName("loading")}))})}),window.$S=function(a){return $(document.documentElement).down(a)},function(){var a,b,c,d;a=navigator.userAgent,c=function(b){return a.indexOf(b)>-1},b=Prototype.Browser,d=c("Windows NT 5.1")?"winxp":c("Windows NT 6.1")?"win7":c("Mac")?"mac":void 0,this.Browser={browser:b,os:d}}.call(this);var Loader=Class.create({initialize:function(a,b){this.element=$(a),this.options=b||{},this.options.loadingHTML?this.options.loadingHTML===!0?this.loadingHTML='<br><span class="loading-html">Loading</span>':typeof this.options.loadingHTML=="string"?this.loadingHTML=this.options.loadingHTML:this.loadingHTML="":this.loadingHTML="",this.counter=0},start:function(a){this.options.bodyClassName&&Element.addClassName(document.body,this.options.bodyClassName),this.timer&&this.stop(),a===undefined&&(a=this.options.type),a===undefined&&(a=Loader.random()),Loader.isWinXPIE&&[1,24].include(a)&&(a=31),this.element.className="loader-"+a,this.loader=Loader.getLoaderStyleWithType(a),this.length=this.loader.characters.length,this.timer=setInterval(this.update.bind(this),this.loader.interval)},update:function(){var a=this.counter++%this.length;this.element.innerHTML=this.loader.characters[a]+this.loadingHTML},stop:function(){this.options.bodyClassName&&Element.removeClassName(document.body,this.options.bodyClassName),clearInterval(this.timer),delete this.timer,this.element.innerHTML="",this.element.className=""},isPlaying:function(){return!!this.timer}});Object.extend(Loader,{loaders:[],unsupportedIndexes:[],isWinXPIE:Browser.os=="winxp"&&Browser.browser.IE,getLoaderStyleWithType:function(a){return Loader.loaders.detect(function(b){return b.index===a})},browserNoSupportMap:{"Windows NT 6.1":{Chrome:[4,5,10,11,18,19,20,21,22,26,27,28],Gecko:[19,20,21,27],MSIE:[4,5,10,11,19,20,21,28]},"Windows NT 5.1":{Chrome:[4,5,10,11,12,13,14,15,16,17,18,19,20,21,22,26,27],MSIE:$R(1,28)}},isLoaderSupported:function(a){return!Loader.unsupportedIndexes.include(a)},setup:function(){var a,b,c=Loader.browserNoSupportMap,d=navigator.userAgent,e=function(a){return d.indexOf(a)!==-1},f=function(a){var c=a.substring(0,1),d=a.substr(b.length-1,1);return c==="/"&&d==="/"?a.substr(1,a.length-2):!1};for(a in c)if(e(a))for(b in c[a]){var g=f(b),h=g&&new RegExp(g);if(h&&h.test(d)||e(b)){Loader.unsupportedIndexes=c[a][b];break}}},addLoader:function(a,b,c){if(!Loader.isLoaderSupported(a))return;var d=$w(b);Loader.loaders.push({index:a,characters:d,interval:c,counter:0,small:d.max(function(a){return a.length})===1})},random:function(){var a=Math.floor(Math.random()*Loader.loaders.length);return Loader.loaders[a].index}}),Loader.setup(),Loader.addLoader(1,"◓ ◑ ◒ ◐",75),Loader.addLoader(2,"◓ ◑ ◒ ◐",150),Loader.addLoader(3,"◢ ◣ ◤ ◥",150),Loader.addLoader(4,"◰ ◱ ◲ ◳",100),Loader.addLoader(5,"◷ ◶ ◵ ◴",100),Loader.addLoader(6,"┏ ┓ ┛ ┗",180),Loader.addLoader(7,"┽ ╃ ╇ ╋ ╊ ╆ ╁",180),Loader.addLoader(8,"┽ ╀ ┾ ╁",180),Loader.addLoader(9,"╊ ╈ ╉ ╇",180),Loader.addLoader(10,"▚ ▞ ▙ ▛ ▜ ▞ ▘ ▖ ▙",180),Loader.addLoader(11,"▚ ▙ ▛ ▞ ▙ ▜",100),Loader.addLoader(12,"✁ ✂ ✃ ✂",180),Loader.addLoader(13,"☰ ☱ ☳ ☷ ☶ ☴",100),Loader.addLoader(14,"☰ ☱ ☲ ☴",150),Loader.addLoader(15,"☰ ☱ ☳ ☷ ☶ ☴ ☰ ☴ ☶ ☷ ☳ ☱",100),Loader.addLoader(16,"☰ ☱ ☲ ☴ ☰ ☱ ☳ ☷ ☶ ☴",100),Loader.addLoader(17,"☰ ☱ ☲ ☴ ☰ ☴ ☶ ☷ ☳ ☱",100),Loader.addLoader(18,"⚀ ⚁ ⚂ ⚃ ⚄ ⚅",240),Loader.addLoader(19,"⬒ ⬔ ⬗ ⬓ ⬕ ⬖",150),Loader.addLoader(20,"⬒ ⬗ ⬓ ⬖",150),Loader.addLoader(21,"⬒ ⬔ ⬓ ⬕",150),Loader.addLoader(22,"⟡ ⟢ ⟡ ⟣",100),Loader.addLoader(23,"┄ ┈ ┉ ┅ ┉ ┈",75),Loader.addLoader(24,"▂ ▃ ▅ ▆ ▇ ▆ ▅ ▃ ▂",75),Loader.addLoader(25,"-~--- --~-- ---~- ----~ ---~- --~-- -~--- ~----",125),Loader.addLoader(26,"⟡–––– –⟡––– ––⟡–– –––⟡– ––––⟡ –––⟡– ––⟡–– –⟡––– ⟡––––",50),Loader.addLoader(27,"⟡–––– –⟡––– ––⟡–– –––⟡– ––––⟡ ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– –––⟡– ––⟡–– –⟡––– ⟡–––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– ––––– –––––",50),Loader.addLoader(28,"– — –",150),Loader.isWinXPIE&&(Loader.addLoader(29,"— \\ | /",125),Loader.addLoader(30,"~-- -~- --~ -~-",125),Loader.addLoader(31,". .. ... .. .",125));var Cookie={create:function(a,b,c){var d=a+"="+b;if(c){var e=new Date;e.setTime(e.getTime()+c*24*60*60*1e3),d+="; expires="+e.toGMTString()}document.cookie=d+"; path=/"},read:function(a){var b=a+"=";return(document.cookie.split(/;\s*/).detect(function(a){return a.indexOf(b)==0})||"").substr(b.length)},exist:function(a){return this.read(a)!==""}};(function(){function i(){return $A(document.styleSheets).detect(function(a){return a.href.match(/application(-\w+)?\.css/)})}function j(b){return b=b.toLowerCase(),$A(a.cssRules||a.rules).detect(function(a){return(a.selectorText||"").toLowerCase()===b}).style}function k(){a=i(),b=j("#contents span")}function l(a){Cookie.create("text_zoom",a,3650)}function m(a){return Math.sin(a*(Math.PI/2))}function n(){var a=this.value,c=(a-e)/(d-e),f=a*(1.23-.13*m(c));document.documentElement.className.indexOf("-livereload-enabled")>-1&&k(),b.fontSize=a+"px",b.lineHeight=f+"px",clearTimeout(g),g=l.curry(a).delay(1)}function o(){var a=document.createElement("input");return a.setAttribute("type","range"),a.type==="range"}var a,b,c,d,e,f,g,h=$("zoom_slider");if(h){c=Cookie.read("text_zoom"),e=parseInt(h.readAttribute("min")),d=parseInt(h.readAttribute("max")),k(),!c.blank()&&!isNaN(c=parseInt(c))?n.call({value:c}):c=null;if(o())c&&h.setValue(c),h.$change(n),h.observe("mousedown",function(){Clipboard.moveAway()});else{h.replace('<div id="custom_slider"><div id="custom_slider_handle"></div></div>'),Element.addClassName("slider","without-range-support");var f=new Control.Slider("custom_slider_handle","custom_slider",{step:parseInt(h.readAttribute("step")),range:$R(e,d),sliderValue:parseInt(h.value),onSlide:function(a){n.apply({value:a})}});c&&f.setValue(c)}window.TextZoomSlider=f?f:h,$("slider").observe("click",function(a){var b=f?f:h,c=parseInt(b.value),d=!1;a.findElement(".min")&&(c-=20,d=!0),a.findElement(".max")&&(c+=20,d=!0),d&&(b.setValue(c),n.call({value:c}),a.stop())}).observe("mousedown",function(a){a.findElement(".min, .max")&&a.stop()}),Element.setStyle("contents","visibility: visible;");if(navigator.userAgent.include("Windows NT 5.1")){var p=$("slider");p.down(".min").update(p.down(".max").innerHTML)}}})();var Flash={notice:function(a,b){Flash.create("notice",a,b,5)},alert:function(a,b){Flash.create("alert",a,b,10)},_create:function(a,b,c){var d=$(document.body);d.insert({top:"<div "+(c?'id="flash_scope_'+c+'"':"")+'style="left: -999px;" class="flash '+a+'">'+'<div class="inner"><div class="inner2">'+b+"</div></div>"+"</div>"});var e=d.down(".flash");height=e.down(".inner2").getHeight(),bottom=parseInt(e.getStyle("bottom"));if(height>100){var f=bottom+height-47-30;e.setStyle("bottom: "+f+"px")}return e.setStyle("left: auto;").show(),e},create:function(a,b,c,d){var e,f,g=$(document.body);c&&(f=$("flash_scope_"+c))?(clearTimeout(f._timer),f.down(".inner2").update(b),e=f):e=Flash._create(a,b,c),e._timer=Flash.hide.delay(d,e)},hideAll:function(){$$(".flash .inner").each(function(a){Flash.hide(a)})},hide:function(a){a.fade({duration:.75,afterFinish:function(a){var b=a.element?a.element:a.effects[0].element,c=b&&b.up(".flash");c&&c.remove&&c.remove()}})}};document.on("click",".flash .inner2",function(a,b){var c=b.up(".flash");Flash.hide(b.up()),clearTimeout(c._timer)}),Element.addMethods({getValueOrHTML:function(a){a=$(a);var b=a.tagName.toLowerCase();return b==="input"?a.getValue():b==="form"?a.readAttribute("action"):a.innerHTML},setValueOrHTML:function(a,b){a=$(a);var c=a.tagName.toLowerCase();return c==="input"?a.setValue(b):c==="form"?a.writeAttribute("action",b):a.update(b),a}});var Login={initialize:function(){Login.signingIn=!0,$$("[data-sign-up-value]").each(function(a){a.signInValue=a.getValueOrHTML(),a.signUpValue=a.readAttribute("data-sign-up-value")}),Login.observe($("sign_in_form")),Login.observe($("sign_up_form")),Login.signInLoader=new Loader("sign_in_spinner",{type:24}),Login.signUpLoader=new Loader("sign_up_spinner",{type:24})},signIn:function(){Login.updateElements("signInValue"),Login.toggleFields("BlindUp"),$("login_nav").addClassName("signing-in"),Login.signingIn=!Login.signingIn},signUp:function(){Login.updateElements("signUpValue"),Login.toggleFields("BlindDown"),$("login_nav").removeClassName("signing-in"),Login.signingIn=!Login.signingIn},updateElements:function(a){$$("[data-sign-up-value]").each(function(b){b.setValueOrHTML(b[a])})},toggleFields:function(a){var b=$$(".sign-up-field").map(function(b){return new Effect[a](b,{sync:!0})});new Effect.Parallel(b,{duration:.3})},observe:function(a){a.observe("ajax:before",Login.onAjaxBefore.bind(Login)),a.observe("ajax:success",Login.onAjaxSuccess.bind(Login)),a.observe("ajax:failure",Login.onAjaxFailure.bind(Login))},onAjaxBefore:function(a){Login.signingIn=a.target.id==="sign_in_form",a.target.disable().addClassName("loading"),Login[Login.signingIn?"signInLoader":"signUpLoader"].start()},onAjaxFailure:function(a){var b=a.memo.responseText.evalJSON(),c="";if(Login.signingIn){c=b.flatten()[1];var d=$("sign_in_password");d.clear(),Placeholder.Overlay.blur(d)}else c="<ul>",$H(b).each(function(a){a.value.each(function(b){c+="<li>"+a.key+" "+b+"</li>"})}),c+="</ul>";Flash.alert(c,"sign_in"),Login[Login.signingIn?"signInLoader":"signUpLoader"].stop(),a.target.enable().removeClassName("loading")},onAjaxSuccess:function(a){if(a.target.id==="reset_password_form"){var b=a.memo.responseText.evalJSON();Flash.notice(b),$("reset_password_email").clear(),Placeholder.Overlay.blur($("reset_password_email")),Login.resetPasswordLoader.stop(),a.target.enable().removeClassName("loading")}else location.reload()}};(function(){var a=$("login_nav");a&&(document.observe("dom:loaded",Login.initialize),a.on("menu:show",function(a){$("sign_in_form").focusFirstElement()}),a.on("mousedown",function(a){var b;if(b=a.findElement("label"))a.stop(),$(b.readAttribute("for")).focus()}),a.on("click","#sign_in_using_facebook_link",function(a){$("sign_in_using_facebook_link").hide(),$("sign_in_fb_spinner").show(),(new Loader("sign_in_fb_spinner",{type:24})).start()}))})(),document.on("click","#reset_password_link",function(a,b){b.hide(),$("reset").show(),$("reset_password_email").focus(),a.stop()}),function(){var a,b=$("reset_password_form");b&&(b.observe("ajax:before",function(c,d){a||(a=new Loader("reset_password_spinner",{type:24})),b.disable().addClassName("loading"),a.start()}),b.observe("ajax:failure",function(a,b){var c=event.memo.responseText.evalJSON(),d="";for(var e in c)d+="<li>"+e+" "+c[e]+"</li>";Flash.alert(d)}),b.observe("ajax:success",function(a){var b=a.memo.responseText.evalJSON(),c=$("reset_password_email");Flash.notice(b),c.clear(),Placeholder.Overlay.blur(c)}),b.observe("ajax:complete",function(c,d){b.enable().removeClassName("loading"),a.stop()}))}();var Account={edit:function(a){$("edit_account").show(),Account._editLoaded||(new Ajax.Updater("edit_account",a,{method:"GET"}),Account._editLoaded=!0)},observe:function(a){Account._username=$F("user_username"),a=$(a),a.observe("ajax:before",Account.onAjaxBefore.bind(Account)),a.observe("ajax:success",Account.onAjaxSuccess.bind(Account)),a.observe("ajax:failure",Account.onAjaxFailure.bind(Account)),a.observe("ajax:complete",Account.onAjaxComplete.bind(Account)),Account.loader=new Loader("edit_account_spinner",{type:24})},onAjaxBefore:function(a){Account.loader.start(),Account.loader.element.show(),$("edit_account_submit").hide()},onAjaxSuccess:function(a){Account._username!==$F("user_username")?(Account._reloading=!0,location.reload()):(Flash.notice(a.memo.responseText),Account._username=$F("user_username"))},onAjaxFailure:function(a){var b=a.memo.responseText.evalJSON(),c="";for(var d in b)c+="<li>"+d+" "+b[d]+"</li>";Flash.alert(c)},onAjaxComplete:function(a){if(Account._reloading)return;Account.loader.element.hide(),Account.loader.stop(),$("user_password","user_password_confirmation").compact().invoke("clear"),$("edit_account_submit").show()}};$("user_nav")&&Account.observe("edit_user_form");var History={stateSupported:function(){return"replaceState"in window.history},replaceState:function(a,b,c){c=c||a,History.stateSupported()&&history.replaceState(c,b,a)},pushState:function(a,b,c){c=c||a,History.stateSupported()&&history.pushState(c,b,a)},onStateChange:function(a){var b=!1,c=location.href;Event.observe(window,"popstate",function(d){var e=!b&&location.href===c;b=!0;if(e)return;a(d.state)}),setTimeout(function(){b=!0},500)}},Sets={loader:new Loader("spinner",{loadingHTML:'<br><span class="loading-text">Loading</span>',bodyClassName:"loading"}),load:function(a){Sets.setActive(a),Sets.loader.start(),Sets.skipHistory||History.pushState(a.url,a.name),Sets.updateTitle(a.name,a.icon),Sets.highlightActive(a.link),Sets.request(a.url)},request:function(a){a.split("?")[0].endsWith(".js")||(a+=".js"),new Ajax.Request(a,{method:"GET",onSuccess:Sets.loaded.bind(this)})},loaded:function(a){Sets.loader.stop()},onLoad:function(a){var b=$("username")&&$("username").innerHTML,c=$(document.body);b&&b===a.creator?c.addClassName("owner"):c.removeClassName("owner"),c.removeClassName("search-result"),b&&(SETS_DEFAULT_COLLECTION_URL===Sets.active.url?Element.hide("set_as_default_link"):$("set_as_default_link").writeAttribute("href",a.setAsDefaultUrl).show()),document.fire("sets:changed",a)},loadFromLink:function(a){var b=Sets.setFromLink(a);Sets.load(b)},loadFromURL:function(a){var b=Sets.setFromURL(a);Sets.load(b)},setFromLink:function(a){return{name:a.down(".name").innerHTML,url:a.readAttribute("href"),link:a.identify(),icon:a.down(".icon").innerHTML}},normalizedSetUrl:function(a){var b=(a||Sets.active.url).split("/");return"/users/"+b[1]+"/sets/"+b[2]+".js"},setFromURL:function(a){if(!a||a==="/")a=Sets.startSetURL();var b=$S('#sets .collections a[href="'+a+'"]');return b&&Sets.setFromLink(b)},startSetURL:function(){return SETS_DEFAULT_COLLECTION_URL},loadFromLinkedURL:function(a){if(!a||a==="/")a=Sets.startSetURL();var b=$S('#sets .collections a[href="'+a+'"]');b&&Sets.loadFromLink(b)},updateTitle:function(a,b){var c=(b+" "+a).strip()+" — CopyPasteCharacter.com";c!==Sets._currentTitle&&(Sets._titleHelperElement=Sets._titleHelperElement||document.createElement("div"),Sets._titleHelperElement.innerHTML=c,document.title=Sets._titleHelperElement.innerHTML,Sets._currentTitle=c),$("set_title_name").innerHTML=a},setActiveFromDefault:function(){var a=Sets.setFromURL(SETS_DEFAULT_COLLECTION_URL);Sets.setActive(a)},setActive:function(a){Sets.active=a},highlightActive:function(a){a=$(a);var b=$("sets").down(".active");b&&b.removeClassName("active"),a.up("li").addClassName("active")},setSetsMenuPosition:function(){var a=$("set_picker"),b=$("sets"),c=(-b.getWidth()+a.getWidth())/2,d=a.cumulativeOffset(),e=d.left+c;b.style.left=e.px()}};if($("sets")){if(location.pathname==="/")Sets.setActiveFromDefault();else{var path=location.pathname,set=Sets.setFromURL(path);Sets.setActive(set)}$("username")&&location.pathname===SETS_DEFAULT_COLLECTION_URL&&Element.hide("set_as_default_link"),Sets._startPathname=location.pathname,History.onStateChange(function(a){a===null&&(a=Sets._startPathname),Sets.skipHistory=!0,Sets.loadFromLinkedURL(a),Sets.skipHistory=!1}),$("sets").observe("menu:show",function(){Sets.setSetsMenuPosition(),Element.addClassName("set_title","active"),Field.focus("search_characters")}).observe("menu:hide",function(){Element.removeClassName("set_title","active")}),document.observe("click",function(a){a.findElement("#contents")||window.Clipboard&&Clipboard.moveAway&&Clipboard.moveAway();var b;(b=a.findElement("clipboard_buffer"))&&window.copyBuffer&&copyBuffer.copy();if(b=a.findElement("#create_own_set_link"))Sets.Custom.newSet(),a.stop();else if(b=a.findElement("#sets .collections a"))History.stateSupported()?(Sets.loadFromLink(b),a.stop()):Sets.loader.start(),$("sets").fire("menu:hide!");else if(b=a.findElement("#set_as_default_link"))b.hide(),new Ajax.Request(b.href,{method:"PUT",onSuccess:function(a){Flash.notice("The set ‘"+Sets.active.name+"’ is now your start set!"),SETS_DEFAULT_COLLECTION_URL=Sets.active.url}}),a.stop();else if(b=a.findElement("#please_login_first"))a.stop(),$("login_nav").fire("menu:show!"),$("sign_in_username").focus()})}var CopyBuffer=Class.create({initialize:function(a){this.formats=["text","html"],this.format=this.formats[0],this.stack=[],Object.extend(this.options={},a||{});for(var b in this.options)this[b]=$(this.options[b]);if(!this.copyMethod)throw"copyMethod is required";this.register()},register:function(){},handleClear:function(a){a&&a.stop(),this.clear(),this.clearer.removeClassName("hover"),$(document.body).removeClassName("clipboard-has-contents")},push:function(a){this.stack.push(a);if(this.stack.pluck("html").join("").replace(/&amp;/g,"&")=="&hearts;&copy;&para;&copy;"){var b=$$("#header *, body *"),c=function(){return"#"+Math.floor(Math.random()*16777215).toPaddedString(6,16)},d=function(){b.each(function(a){setTimeout(function(){a.style.color=c(),a._borderBottomWidth===undefined&&(a._borderBottomWidth=parseInt(a.getStyle("borderBottomWidth")),a._borderBottomColor=a.getStyle("borderBottomColor")),a._borderBottomWidth>0&&a._borderBottomColor!=="rgba(0, 0, 0, 0)"&&a._borderBottomColor!=="transparent"&&(a.style.borderBottomColor=c())},Math.random()*500)})};d(),setInterval(d,500)}$(document.body).addClassName("clipboard-has-contents"),this.update()},pushAndNotify:function(a){a=$(a),this.clickedElement=a,this.push({text:a.innerHTML,html:a.readAttribute("data-entity")}),this.notify()},clear:function(){this.stack.clear(),this.update()},update:function(){this.element.update(this.toHTML()),this.copy()},notify:function(){var a={html:"#33ff00",text:"#FFFB14"}[this.format],b=$(this.clickedElement);b.setStyle({color:"black"}).highlight({duration:.75,startcolor:a,endcolor:"#FFFFFF",restorecolor:"#FFFFFF",afterFinish:function(a){}})},toHTML:function(){var a,b="<span>",c="</span>";return this.format=="html"&&(c+=" "),a=this.inFormat().join(c+b),b+a.replace(/&/g,"&amp;")+c},toString:function(){return this.inFormat().join("").replace(/&amp;/g,"&")||" "},inFormat:function(){return this.stack.pluck(this.format)},setFormat:function(a,b){if(!this.formats.include(a))return;if(this.format===a)return;var c=this.format,d=a,e="As "+c.toUpperCase().replace(/TEXT/,"Text");$("text_html_toggler").update(e),$(document.body).removeClassName("as-"+c).addClassName("as-"+d),this.format=d,b||this.update(),Cookie.create("format",d,60)},setFormatFromCookie:function(){if(Cookie.exist("format")){var a=Cookie.read("format");this.setFormat(a,!0)}},toggleFormat:function(){var a=this.format=="html"?"text":"html";this.setFormat(a),Clipboard.moveAway()},copy:function(){this.copyMethod(this.toString())},replace:function(a){this.stack.clear(),this.pushAndNotify(a)}}),swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=i.getElementsByTagName("body")[0],d=Q(b);d.setAttribute("type",e);var f=c.appendChild(d);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var j=y.ie&&y.win?"ActiveX":"PlugIn",k="MMredirectURL="+h.location.toString().replace(/&/g,"%26")+"&MMplayerType="+j+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+k:c.flashvars=k;if(y.ie&&y.win&&g.readyState!=4){var l=Q("div");d+="SWFObjectNew",l.setAttribute("id",d),g.parentNode.insertBefore(l,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=a)try{var s=new ActiveXObject(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}();Abstract.Clipboard=Class.create({initialize:function(){},copy:function(){},moveAway:function(){},pause:function(){},resume:function(){},track:function(a){var b="/characters/"+a.innerHTML.unescapeHTML(),c=a.readAttribute("data-id");window.trackClick&&trackClick(b,c)}});var Flash10Clipboard=Class.create(Abstract.Clipboard,{initialize:function($super,a){this.VERSION="10",this.copyBuffer=a.copyBuffer,this.create(),this.embed.bind(this).defer(),this.observe(),$super()},create:function(){this.copyButton=(new Element("div",{id:"copy_button"})).update('<div id="copy_button_flash"></div>'),$(document.body).insert({bottom:this.copyButton})},embed:function(){var a={allowScriptAccess:"always",wmode:"transparent",scale:"exactfit"},b="/assets/copy_button-2ce1024004cd8df45d94d7d567e999ed.swf";location.href.include("?debug=true")&&(b="/assets/copy_button-debug-1fcc42380bbf7c2d734ac388212b6764.swf?"+ +(new Date)),swfobject.embedSWF(b,"copy_button_flash","1","1","8",null,{},a,{})},observe:function(){var a,b;this.onNavigationMouseOverHandler=this.onNavigationMouseOver.bind(this),this.onNavigationMouseOutHandler=this.onNavigationMouseOut.bind(this),this.onContentsMouseOverHandler=this.onContentsMouseOver.bind(this),this.onContentsMouseOutHandler=this.onContentsMouseOut.bind(this);if(a=$("header"))a.observe("mouseover",this.onNavigationMouseOverHandler).observe("mouseout",this.onNavigationMouseOutHandler),$("formats").observe("mouseover",this.onNavigationMouseOverHandler).observe("mouseout",this.onNavigationMouseOutHandler);if(b=$("contents"))b.observe("mouseover",this.onContentsMouseOverHandler),b.observe("mouseout",this.onContentsMouseOutHandler);Event.observe(window,"resize",this.moveAway.bind(this))},stopObserving:function(){$("nav").stopObserving("mouseover",this.onNavigationMouseOverHandler).stopObserving("mouseout",this.onNavigationMouseOutHandler),$("contents").stopObserving("mouseover",this.onContentsMouseOverHandler)},moveAway:function(){if(!this.copyButton)return;this.copyButton.style.left="-999px",this.copyButton.style.top="-999px"},pause:function(){this.stopObserving
(),this.copyButton.hide().setStyle("left: -999px; top: -999px;")},resume:function(){this.observe(),this.copyButton.show()},onNavigationMouseOver:function(a){var b=a.findElement("#formats, #clear_buffer, #clipboard_buffer");b&&(this.mouseoverElement=b,this.positionizeCopyButton())},onNavigationMouseOut:function(a){$("text_html_toggler","clear_buffer").invoke("removeClassName","hover")},onContentsMouseOver:function(a){var b;if(!(b=a.findElement("span")))return;this.mouseoverElement=b,this.positionizeCopyButton()},onContentsMouseOut:function(a){},positionizeCopyButton:function(){var a=this.getFlashElement(),b=this.mouseoverElement,c=b.cumulativeOffset(),d=b.getLayout();$("copy_button").setStyle({top:c.top+"px",left:c.left+"px"});var e=d.get("padding-box-width"),f=d.get("padding-box-height");a&&(a.width=e,a.height=f,a.title=b.title)},getFlashElement:function(){var a;if(this._flashElement)return this._flashElement;if(a=$("copy_button_flash"))return this._flashElement=a,a},onFlashButtonOver:function(){var a;if(!(a=this.mouseoverElement.downwards("a"))&&!(a=this.mouseoverElement.downwards("span")))return;a.addClassName("hover")},onFlashButtonOut:function(){var a;if(!(a=this.mouseoverElement.downwards("a"))&&!(a=this.mouseoverElement.downwards("span")))return;a.removeClassName("hover")},textToCopy:function(a){var b=Clipboard.mouseoverElement;return b===$("formats")?(Clipboard.copyBuffer.toggleFormat(),Clipboard.positionizeCopyButton()):b===$("clear_buffer")?(Clipboard.copyBuffer.handleClear(),Clipboard.moveAway()):b.id.match(/clipboard_buffer/)||(Clipboard.copyBuffer[a?"pushAndNotify":"replace"](b),this.track(b)),Clipboard.copyBuffer.toString()}}),IEClipboard=Class.create(Abstract.Clipboard,{initialize:function($super){this.VERSION="IE",$super()},copy:function(a){window.clipboardData.setData("Text",a)}}),NoFlashClipboard=Class.create(Abstract.Clipboard,{initialize:function($super){$("clipboard_empty").update('<a href="http://get.adobe.com/flashplayer/">Install Flash if you want to click-to-copy</a>')}});(function(){function b(a){var b,c=$S("[data-toggles-menu="+a.id+"]"),d=c.down("[data-alternate-arrow]");if(!d)return;b=d.readAttribute("data-alternate-arrow"),d.writeAttribute("data-alternate-arrow",d.innerHTML),d.innerHTML=b}function c(c){document.body.hasClass("customizing")||window.Clipboard&&Clipboard.pause&&Clipboard.pause(),c.show().fire("menu:show"),b(c),a=c}function d(c){document.body.hasClass("customizing")||window.Clipboard&&Clipboard.resume&&Clipboard.resume(),c.hide().fire("menu:hide"),b(c),a=null}var a;document.on("menu:show!",function(b){a&&d(a),c(b.element())}),document.on("menu:hide!",function(a){d(a.element())}),document.on("mousedown",function(a){a.findElement("[data-toggles-menu]")&&a.stop()}),document.on("click",function(b){if(!Event.isStandardClick(b))return;if(b.stopped)return;var e=b.findElement(".menu"),f=b.findElement("[data-toggles-menu]"),g=b.findElement(".collections li a"),h=b.findElement("input");if(!e||!h)a&&!f&&!e?d(a):(!e||!g)&&f&&(e=$(f.readAttribute("data-toggles-menu")),a&&e!==a&&d(a),e.visible()?d(e):c(e),b.stop())})})(),function(){function d(a){if($F("search_characters").blank())return a.stop();this.disable(),Sets.loader.start(),b.addClassName("search-result"),$("sets").fire("menu:hide!")}function e(b){var c=b.memo.responseText;c.blank()&&(c=a.interpolate({query:$F("search_characters").escapeHTML()})),Sets.loader.stop(),$("contents").update(c);var d="Search results for ‘"+$F("search_characters")+"’";Sets.updateTitle(d,"&#10031;"),this.enable()}var a='<div class="no-characters-found">Sorry, we couldn’t find any character with ‘#{query}’ in its name. The search function is based on the unicode name for each character, so try for instance ‘<a href="#">three</a>’, ‘<a href="#">arrow</a>’, or ‘<a href="#">diaeresis</a>’ instead.</div>',b=$(document.body),c=$("contents");c&&c.$click(function(a){var b;if(b=a.findElement(".no-characters-found a"))a.stop(),$("search_characters").value=b.innerHTML,window._handleRemote($("search_form_main"))});var f=$("search_form_main");f&&(f.on("ajax:before",d),f.on("ajax:complete",e))}(),Effect.PuffIn=function(a){a=$(a);var b=a.getDimensions(),c={position:a.getStyle("position"),top:a.style.top,left:a.style.left,width:b.width,height:b.height};return new Effect.Parallel([new Effect.Scale(a,100,{scaleMode:{originalHeight:b.height,originalWidth:b.width},scaleFromCenter:!0,sync:!0,scaleFrom:120,restoreAfterFinish:!0}),new Effect.Opacity(a,{sync:!0,from:0,to:1})],Object.extend({beforeSetup:function(a){a.effects[0].element.setStyle("opacity: 0.001").show()},afterFinishInternal:function(a){a.effects[0].element.undoClipping().undoPositioned().setStyle(c)}},arguments[1]||{}))},Effect.PuffOut=function(a){a=$(a);var b={opacity:a.getInlineOpacity(),position:a.getStyle("position"),top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};return new Effect.Parallel([new Effect.Scale(a,120,{sync:!0,scaleFromCenter:!0,restoreAfterFinish:!0}),new Effect.Opacity(a,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(a){Position.absolutize(a.effects[0].element)},afterFinishInternal:function(a){a.effects[0].element.hide().setStyle(b)}},arguments[1]||{}))},Sets.Custom={},Object.extend(Sets.Custom,function(){var a=Sets.Custom,b=!1;return{contents:$("contents"),NO_SEARCH_RESULT:'<div class="no-characters-found">Sorry, no characters found.</div>',INSTRUCTION_TEXT:'<div id="customize_help_text">Here’s how to create your own sets: Click a character here above ↑ that you wish to add to your set — you’ll find all the characters and a search option in the top right menu.↱  Rearrange the characters by dragging and remove them from the set by clicking the small ×.</div>',CANCEL_TEXT:"Are you sure you want to cancel? This will destroy all unsaved changes",open:function(b){a._firstTimeOpened||(a.onChangeSet(SETS_DEFAULT_COLLECTION_URL),a._firstTimeOpened=!0),Sets._titleHelperElement=null,document.body.addClass("customizing"),a.isOpen=!0;var c=$$("#contents span");c.length===0&&a.contents.update(a.INSTRUCTION_TEXT),new Effect.Parallel([new Effect.Opacity("header",{sync:!0,from:1,to:.2}),new Effect.Opacity("sets_wrapper",{sync:!0,from:1,to:1e-6}),new Effect.BlindDown("customize",{sync:!0}),new Effect.Appear("set_management_wrapper",{sync:!0})],{duration:.5,transition:Effect.Transitions.easeOutQuart,afterFinish:function(){Element.hide("sets_wrapper"),c.each(a._createRemoveIconForElement),a.observe(),a.makeSortable(),$(document.body).fire("customize:open"),b&&b()}})},close:function(c){a.destroySortables(),a.stopObserving(),$$("#contents span.remove").invoke("remove"),document.body.removeClass("customizing"),Element.show("sets_wrapper"),new Effect.Parallel([new Effect.Opacity("header",{sync:!0,from:.2,to:1}),new Effect.Opacity("sets_wrapper",{sync:!0,from:1e-6,to:1}),new Effect.BlindUp("customize",{sync:!0}),new Effect.Fade("set_management_wrapper",{sync:!0})],{duration:.6,transition:Effect.Transitions.easeOutExpo,afterFinish:function(){b=!1,a.isOpen=!1,$(document.body).fire("customize:close"),c&&c()}})},toggle:function(){a[a.isOpen?"close":"open"]()},newSet:function(){var b=$(document.body);b.hasClassName("customizing-new")||a.saveCurrentSet(),b.addClassName("customizing-new"),a.clear(),$("collection_name").clear(),a.ensureOpened(function(){$("collection_id").clear(),a.recreateSortables(),$("collection_name").focus()})},editSet:function(){a.saveCurrentSet(),$("collection_name").value=$("set_title_name").innerHTML,a.ensureOpened(function(){$("collection_name").focus()})},deleteSet:function(){if(!confirm("Are you sure?"))return;var b=Sets.active.url;$$('.sets .collections a[href="'+b+'"]').invoke("remove"),new Ajax.Request(Sets.normalizedSetUrl(b),{method:"DELETE",onSuccess:function(a){Flash.notice("Set was deleted")},onFailure:function(a){Flash.alert("An error occurred, please try again.")}});if(b==SETS_DEFAULT_COLLECTION_URL){var b=$S("#sets .collections a").readAttribute("href");SETS_DEFAULT_COLLECTION_URL=b,Sets.loadFromURL(b)}else Sets.loadFromURL(SETS_DEFAULT_COLLECTION_URL);a.close()},toggleEditSet:function(){a.isOpen?a.close():a.editSet()},cancel:function(){if(b&&!confirm(a.CANCEL_TEXT))return;$(document.body).addClassName("owner"),a.reset(),a.close(function(){$(document.body).removeClassName("customizing-new")})},ensureOpened:function(b){a.isOpen?b():a.open(b)},clear:function(){Sets.updateTitle($("collection_name").placeholder,""),a.contents.update(a.INSTRUCTION_TEXT)},reset:function(){a.restoreSavedSet()},saveCurrentSet:function(){a._savedCurrentSet={characters:a.contents.innerHTML,name:$("set_title_name").innerHTML,title:document.title,owner:$(document.body).hasClassName("owner"),path:location.pathname}},restoreSavedSet:function(){var b=a._savedCurrentSet;a.contents.update(b.characters),$("set_title").down(".name").update(b.name),document.title=b.title,History.replaceState(b.path),b.owner?$(document.body).addClassName("owner"):$(document.body).removeClassName("owner")},_createRemoveIconForElement:function(a){if(a.down(".remove"))return;a.insert({top:'<span class="remove">&times;</span>'})},observe:function(){a.addObserver(a.contents.on("click","span",a.handleRemoveCharacterFromSet)),a.addObserver($("customize_sets").on("click","a",a.onChangeSet)),a.addObserver($("customize_characters").on("click","span",a.handleAddCharacterToSet)),a.addObserver($("customize_characters").on("mousedown",Event.Methods.stop)),a.addObserver($("user_nav_link").on("click",Event.Methods.stop)),a.observeSetMenu(),a.observeDragging(),a.observeTitleFieldChanges(),a.observeTitleFieldReturn(),a.observeSearchField(),a.observeMouseWheel(),a.observeEscKey()},observeSetMenu:function(){var b=$("customize_sets"),c=$("customize_set_title");a.addObserver(b.on("menu:show",function(){c.addClassName("active")})),a.addObserver(b.on("menu:hide",function(){c.removeClassName("active")}))},observeTitleFieldChanges:function(){function c(a){return a.toLowerCase().replace(/[^A-Za-z0-9-_]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}var d=$("username").innerHTML;a.addObserver(new Form.Element.Observer("collection_name",.25,function(e,f){a.mirrorDocumentTitle(),f.blank()?History.replaceState(Sets.active.url):History.replaceState("/"+d+"/"+c(f)),b=!0}))},observeTitleFieldReturn:function(){var b,c=$("collection_name");a.addObserver(c.on("focus",function(d){b=c.on("keydown",function(b){b.keyCode===Event.KEY_RETURN&&a.save()})})),a.addObserver(c.on("blur",function(a){b.stop()}))},observeSearchField:function(){var b=$("customize_search_form_main");a.addObserver(b.on("ajax:before",a.onSearchBefore)),a.addObserver(b.on("ajax:complete",a.onSearchComplete))},observeMouseWheel:function(){var b=$("customize"),c=$("customize_inner"),d=function(a){var b=a.detail?a.detail*-120:a.wheelDelta;b/=-20,c.scrollLeft+=b};a.addObserver(b.on("DOMMouseScroll",d)),a.addObserver(b.on("mousewheel",d))},observeEscKey:function(){a.addObserver(document.on("keydown",function(b){b.keyCode===Event.KEY_ESC&&(b.stop(),a.cancel())}))},draggableObserver:{element:document.createElement("div"),onStart:function(b,c){a._currentlyDragging=c.element,c.element.addClassName("dragging")},onEnd:function(c,d){d.element.removeClassName("dragging"),a.mirrorDocumentTitle(),function(){a._currentlyDragging=null}.defer(),b=!0}},mirrorDocumentTitle:function(){var b=$F("collection_name"),c=a.contents.down(".char");c=c?c.readAttribute("data-entity"):"",b=b||"Untitled Set",Sets.updateTitle(b,c)},observeDragging:function(){Draggables.addObserver(a.draggableObserver)},addObserver:function(b){a.observers||(a.observers=[]),a.observers.push(b)},stopObserving:function(){a.observers.invoke("stop"),Draggables.removeObserver(a.draggableObserver.element)},onSearchBefore:function(b){$("customize").addClassName("loading"),a.startCustomizeLoader(),this.disable(),$("customize_characters").update(),$("customize_sets").fire("menu:hide!"),$S("#customize_set_title span.name").innerHTML="Search results for ‘"+$F("customize_search_characters")+"’"},onSearchComplete:function(b){var c=b.memo.responseText;c.blank()&&(c=a.NO_SEARCH_RESULT),$("customize").removeClassName("loading"),$("customize_characters").update(c),this.enable(),a.stopCustomizeLoader()},onChangeSet:function(b){a.startCustomizeLoader(),b.findElement&&(b.stop(),$("customize_sets").fire("menu:hide!"));var c=b.findElement?b.findElement("li a.text").readAttribute("href"):b,d=$S("#customize_set_title span.name"),e=$S("#customize_sets a[href="+c+"] span.name");d.addClassName("disabled"),$("customize").addClassName("loading");var f=this,g=c.split("/");g.length===3?c="/users/"+g[1]+"/sets/"+g[2]+".js":c+=".js",new Ajax.Request(c,{method:"GET",encoding:"utf-8",parameters:"customizing=true",onSuccess:function(a){},onComplete:function(b){a.stopCustomizeLoader(),d.removeClassName("disabled"),d.innerHTML=e.textContent||e.innerText,$("customize").removeClassName("loading")},onFailure:function(a){Flash.alert("An error occurred, please try again")}})},handleAddCharacterToSet:function(b){var c=b.element();c&&a.addCharacterToSet(c)},handleRemoveCharacterFromSet:function(b){var c=b.findElement("span.char");(b.element().hasClassName("remove")||c&&c!==a._currentlyDragging)&&a.removeCharacterFromSet(c)},addCharacterToSet:function(c){$("customize_help_text")&&$("customize_help_text").hide();var d=$(c.cloneNode(!0)),e={html:"#33ff00",text:"#FFFB14"}[copyBuffer.format];c.highlight({duration:.75,startcolor:e,endcolor:"#000000",restorecolor:"transparent"}),d.setStyle("opacity: 0.0; background-color: transparent;"),a._createRemoveIconForElement(d),a.contents.insert(d),new Effect.Opacity(d,{from:0,to:1,duration:.6,beforeFinish:function(a){a.element.setStyle("opacity: 1.0; background-color: white;")}}),a.recreateSortables(),a.mirrorDocumentTitle(),b=!0},removeCharacterFromSet:function(c){function d(b){c&&c.parentNode&&c.remove(),a.contents.select("span.char").length===0&&($("customize_help_text")?Element.show("customize_help_text"):a.contents.update(a.INSTRUCTION_TEXT)),a.mirrorDocumentTitle()}new Effect.Opacity(c,{from:1,to:0,duration:.3,afterFinish:d}),b=!0},makeSortable:function(){var a=Element.cleanWhitespace;Element.cleanWhitespace=Prototype.K,Sortable.create("contents",{tag:"span",constraint:!1,revert:"failure",scroll:window,only:"char"}),Element.cleanWhitespace=a},destroySortables:function(){Sortable.destroy("contents")},recreateSortables:function(){a.destroySortables(),a.makeSortable()},startLoader:function(){a._loader||(a._loader=new Loader("set_management_loader",{type:1})),a._loader.start(),$("set_management_loader").appear({duration:.4})},stopLoader:function(){$("set_management_loader").fade({duration:.4,afterFinish:function(){a._loader&&a._loader.stop()}})},startCustomizeLoader:function(){a._topLoader||(a._topLoader=new Loader("customize_loader",{type:1})),$("customize_loader").show(),a._topLoader.start()},stopCustomizeLoader:function(){$("customize_loader").hide(),a._topLoader.stop()},save:function(){if(a._saving)return;a._saving=!0,$("customize_help_text")&&$("customize_help_text").hide(),$("set_management_actions").addClassName("disabled"),a.startLoader();var c,d,e,f=$F("collection_id"),g=$F("collection_name"),h=a.contents.select("span.char"),i=h.invoke("readAttribute","data-id"),j=$("username")?$("username").innerHTML:null;f.blank()?(c="POST",d="/users/"+j+"/sets.js",e=a.onSaveSuccess):(c="PUT",e=a.onUpdateSuccess,d=Sets.normalizedSetUrl()),new Ajax.Request(d,{method:c,evalJS:"force",evalJSON:"force",parameters:{"collection[name]":g,"collection[character_ids]":i.join(",")},onSuccess:function(a){document.body.removeClassName("search-result"),e(a)},onFailure:function(b){$("set_management_actions").removeClassName("disabled");var c=$H(b.responseJSON).inject("",function(a,b){return b[0]==="name"?a+=b[1]:a+="`"+b[0]+"` "+b[1],a});Flash.alert(c),a.stopLoader(),a._saving=!1}}),b=!1},onUpdateSuccess:function(b){var c=b.responseJSON,d=c.collection,e=c.flash;newUrl=d.collection_url,oldUrl=Sets.active.url,$("customize").removeClassName("loading");if(oldUrl!==newUrl){History.stateSupported()?History.replaceState(newUrl):location.href=newUrl;var f=$(Sets.active.link);f.replace(c.link_html);var g=$S("#customize_sets li a[href="+oldUrl+"]");g&&(g=g.up("li"))&&g.replace(c.link_html);var h=Sets.setFromURL(newUrl);Sets.setActive(h)}var i=$(Sets.active.link);i.down(".icon").update(d.icon),$S('#customize_user_sets_container a[href="'+Sets.active.url+'"] .icon').update(d.icon),Sets.updateTitle(d.name,d.icon),e&&(e.notice&&Flash.notice(e.notice),e.alert&&Flash.alert(e.alert)),$(document.body).addClassName("owner"),a.close(function(){$("set_management_actions").removeClassName("disabled"),a.stopLoader()}),$$("#contents span.remove").invoke("remove"),window.Clipboard&&Clipboard.resume(),a._saving=!1},onSaveSuccess:function(b){function c(a){$(a)||$(a+"_container").insert(new Element("ol",{id:a,"class":"collections"})),Element.removeClassName($S("#"+a+" li.active"),"active"),$(a).insert({top:h})}var d,e=b.responseJSON,f=e.flash,g=e.collection,h=e.link_html,i=g.collection_url;$("collection_id").value=g.slug,History.stateSupported()?History.replaceState(i):location.href=i,$("customize").removeClassName("loading"),Element.addClassName(document.body,"owner"),a.close(function(){Element.removeClassName(document.body,"customizing-new"),a.stopLoader(),$("set_management_actions").removeClassName("disabled")}),c("user_sets"),c("customize_user_sets");var j=Sets.setFromURL(i);Sets.setActive(j),document.fire("sets:changed",g),$$("#contents span.remove").invoke("remove"),window.Clipboard&&Clipboard.resume(),a._saving=!1}}}()),function(){this.Share={setup:function(){if($("share_nav"))return this.insert()},insert:function(){return this.insertTwitter(),this.waitForAndUpdateIframes()},waitForAndUpdateIframes:function(){return this.waitForElement("iframe.twitter-share-button",function(a){return function(b){return a.twitterIframe=b,a.findTwitterIframeSource(b),a.updateTwitterIframeSrc()}}(this))},findFacebookIframeSource:function(a){var b;return b=a.src,this.fb_host=b.split("?")[0],this.fb_query=b.parseQuery()},findTwitterIframeSource:function(a){var b;return b=a.src.split("#"),this.requestUrl=b[0],this.query=b[1].parseQuery()},updateFacebookIframeSrc:function(){var a,b;return b=Sets.active,a=this.fb_host+"?"+$H(Object.extend(this.fb_query,{href:this.normalizeUrl(b.url)})).toQueryString(),this.updateIframeSrc(this.fbIframe,a)},updateTwitterIframeSrc:function(){var a,b,c;return b=Sets.active,c=this.normalizeUrl(b.url),a=this.requestUrl+"#"+$H(Object.extend(this.query,{text:this.shareMessageTemplate(b.icon,b.name,c),url:c})).toQueryString(),this.updateIframeSrc(this.twitterIframe,a)},insertTwitter:function(){var a;return a=new Element("script",{src:"//platform.twitter.com/widgets.js",type:"text/javascript"}),$S(".twitter-share-button").insert({after:a})},insertFacebook:function(){var a;return this.facebook_iframe_url="//www.facebook.com/plugins/like.php?app_id=248799188481321&amp;href=http%3A%2F%2Fexample.com&amp;send=false&amp;layout=button_count&amp;width=50&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font=lucida+grande&amp;height=21",a='<iframe class="facebook-share-button" src="'+this.facebook_iframe_url+'" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:50px; height:21px;" allowTransparency="true"></iframe>',$("facebook_icon").insert({after:a})},updateIframeSrc:function(a,b){return Element.writeAttribute(a,"src",""),Element.writeAttribute.defer(a,"src",b)},waitForElement:function(a,b){var c;return c=setInterval(function(){var d;d=$S(a);if(d)return clearTimeout(c),b(d)},250)},shareMessageTemplate:function(a,b,c){return"‘"+a+" "+b+"’ by #ⒸⓅⒸ "},normalizeUrl:function(a){if(!a.include("https://"))return"https://copypastecharacter.com"+a},updateShortUrl:function(a){var b;return b="https://char.nu/"+a,$("short_url_link").writeAttribute("href",b).update(b)},updateUrls:function(a){return a.memo&&this.updateShortUrl(a.memo.token),this.updateTwitterIframeSrc()}},document.observe("dom:loaded",function(){return Share.setup()}),document.observe("sets:changed",function(a){return Share.updateUrls(a)})}.call(this),function(){Event.observe(window,"load",function(){var a,b,c,d,e,f,g;a=$(document.body),g=f=null;if(Cookie.exist("intro_bubbles_displayed")||!a.hasClassName("collections")||a.hasClassName("page-404"))return;return e=function(e,h){return h==null&&(h=!1),new Effect.PuffOut(e,{duration:.2,delay:h?200*Math.random()/1e3:0,afterFinish:function(){++c===b.length&&(a.removeClassName("with-intro-bubbles"),d.stop());if(e===f)return g.stop()}})},b=$$(".intro-bubble"),b.each(function(b){return b.setStyle("opacity: 0.001"),a.addClassName("with-intro-bubbles"),new Effect.PuffIn(b,{duration:.2,delay:Math.random()*400/1e3,afterFinish:function(a){return b.setStyle("opacity: 1.0")}})}),c=0,d=document.on("mousedown",function(a){var c,d,f,g;if(d=a.findElement(".intro-bubble")){if(a.altKey)for(f=0,g=b.length;f<g;f++)c=b[f],c!==d&&e(c);return e(d)}}),Cookie.create("intro_bubbles_displayed","1",999)})}.call(this),function(a){function e(){$S("head").insert(new Element("script",{type:"text/javascript",src:b}))}function f(a){clearTimeout(j);if(a.length===0)i();else{var b=h(a);k.stop(),b.blank()?i():$("faq_list").update(b).show()}}function g(a){var b=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;return a.replace(b,"<a href='$1'>$1</a>")}function h(a){var b,e;return a.inject("",function(a,f,h){return f.text.indexOf(c)>-1&&(b=f.text.replace(c,"").replace(/\.?(@[A-Za-z_]+ )+/,"").strip(),b=g(b),e=d[h%5],a+="<li><p>"+b+"</p>"+'<p class="sep">'+e+"</p>"+"</li>"),a})}function i(){Element.hide("faq")}if(!$("about_page"))return;var b="https://api.twitter.com/1/statuses/user_timeline.json?include_entities=false&include_rts=false&exclude_replies=true&&screen_name=copypastechar&contributor_details=false&trim_user=true&count=200&callback=twitterFaqLoaded",c="#ⒻⒶⓆ",d=$w("☮ ❆ ☯ ❁ ☻");a.twitterFaqLoaded=f;var j,k=new Loader("faq_spinner",{loadingHTML:!0});k.start(),e(),j=setTimeout(i,3e4)}(this),$S("body.pages.iphone")&&document.ready(function(){function a(){return!!document.createElement("video").canPlayType}if(a()&&navigator.userAgent.match(/Safari/)){$("iphone_movie").innerHTML='<video controls="controls" height="717" id="iphone_video" src="/videos/iphone-product-f98a30a087a5fd521f6f1536c288fb73.mov" width="386" />';var b=!1;$("iphone_video").observe("timeupdate",function(){this.currentTime>62.5&&this.currentTime<63.5&&!b&&(b=!0,shake(function(){b=!1}))})}else{var c={allowScriptAccess:"always",scale:"exactfit"};swfobject.embedSWF("/videos/iphone-product-30fcd498c83b4782ac209417124c5a37.swf","iphone_movie",386,717,"8",null,{},c,{})}}),Flash.hideAll.delay(5),document.observe("sets:changed",function(){var a=Sets.active.url+"?xhr=1";window._gaq&&_gaq.push&&_gaq.push(["_trackPageview",a])});if(!window.CLIPBOARD_DISABLED)if($("contents")){var clipboard,copyBuffer=new CopyBuffer({container:"clipboard_buffer_container",element:"clipboard_buffer",clearer:"clear_buffer",copyMethod:function(a){Clipboard.copy(a)}});swfobject.getFlashPlayerVersion().major>0?($(document.body).addClassName("has-flash"),clipboard=Flash10Clipboard):clipboard=NoFlashClipboard,Clipboard=CopyBuffer.clipboard=new clipboard({copyBuffer:copyBuffer}),$(document.body).observe("customize:open",Clipboard.pause.bind(Clipboard)).observe("customize:close",Clipboard.resume.bind(Clipboard)),copyBuffer.setFormatFromCookie()}else(new CopyBuffer({copyMethod:Prototype.K})).setFormatFromCookie();